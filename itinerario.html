<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Itinerario - GlobalGlide360</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Poppins',sans-serif;color:#222;background:#fff;line-height:1.5;}

    /* HEADER */
    header{
      position:fixed;top:0;left:0;width:100%;
      background:linear-gradient(90deg,#0077b6,#00b4d8);color:white;
      display:flex;justify-content:center;align-items:center;
      padding:14px 20px;box-shadow:0 4px 8px rgba(0,0,0,0.1);z-index:1000;
    }
    header img{height:70px;margin-right:10px;}
    header h1{
      font-size:30px;font-weight:600;letter-spacing:1px;
      background:linear-gradient(45deg,#fff,#cce7f4);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }

    /* HERO */
    .hero{position:relative;height:45vh;overflow:hidden;display:flex;align-items:center;justify-content:center;}
    .hero img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;filter:brightness(0.85);}
    .hero::after{content:'';position:absolute;inset:0;background:rgba(0,0,0,0.3);}
    .hero-content{position:relative;z-index:1;text-align:center;color:white;padding:20px;}
    .hero-content h2{font-size:34px;font-weight:600;text-shadow:0 3px 6px rgba(0,0,0,0.6);}

    /* CONTAINER */
    .container{max-width:1000px;margin:30px auto;padding:20px;}
    .card{
      background:white;padding:20px;border-radius:12px;
      box-shadow:0 4px 10px rgba(0,0,0,0.08);margin-bottom:25px;
    }
    .card h3{
      margin-bottom:10px;color:#0077b6;font-size:20px;
      border-bottom:1px solid #eee;padding-bottom:8px;
    }
    .card img{width:100%;border-radius:8px;margin-bottom:10px;}
    .links a{
      display:inline-block;margin:6px 0;color:white;
      background:#0077b6;padding:8px 14px;border-radius:6px;
      font-size:14px;text-decoration:none;
    }
    .links a:hover{background:#00b4d8;}

    .day-card{
      background:#f8f9fa;margin-bottom:15px;padding:15px;border-radius:10px;
      border-left:5px solid #0077b6;
    }
    .day-card h4{color:#0077b6;margin-bottom:6px;font-size:18px;}
    .day-card p{font-size:15px;line-height:1.4;}

    #download-pdf{
      display:block;margin:20px auto;background:#00b4d8;color:white;border:none;
      padding:12px 18px;font-size:16px;border-radius:8px;cursor:pointer;display:none;
    }

    footer{background:#222;color:#ccc;text-align:center;font-size:14px;padding:20px;margin-top:20px;}
  </style>
</head>
<body>
  <header>
    <div style="display:flex;align-items:center;">
      <img src="logo-globalglide360.png" alt="GlobalGlide360">
      <h1>GlobalGlide360</h1>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <img src="hero-travel-new.png" alt="Hero Travel">
    <div class="hero-content">
      <h2>Il tuo itinerario personalizzato</h2>
    </div>
  </section>

  <div class="container">
    <h2 id="title-itinerario" style="margin-bottom:20px;color:#0077b6;">Caricamento itinerario...</h2>
    <div id="itinerario-container"></div>
    <button id="download-pdf">üìÑ Scarica in PDF</button>
  </div>

  <footer>
    <p>¬© 2025 GlobalGlide360 ‚Äì Tutti i diritti riservati</p>
  </footer>

<script>
const container = document.getElementById("itinerario-container");
const title = document.getElementById("title-itinerario");
const btnPDF = document.getElementById("download-pdf");

const params = new URLSearchParams(window.location.search);
const itinerarioId = params.get("id");
const pdfMode = params.get("pdf");

if(!itinerarioId){
  title.innerText = "‚ùå Nessun itinerario trovato";
}else{
  (async () => {
    const res = await fetch(`/api/itinerari?id=${itinerarioId}`);

    if (!res.ok) {
      title.innerText = "‚ùå Itinerario non trovato";
      return;
    }

    const data = await res.json();
    title.innerText = `Itinerario per ${data.destinazione}`;

    container.innerHTML = `
      <div class="card">
        <h3>‚úàÔ∏è Voli</h3>
        ${data.voli.map(v => `
          <img src="${v.immagine}" alt="Volo">
          <p>${v.titolo} - ${v.prezzo}</p>
          <div class="links"><a href="${v.link}" target="_blank">üîó Prenota volo</a></div>
        `).join("")}
      </div>
      <div class="card">
        <h3>üè® Hotel</h3>
        ${data.hotel.map(h => `
          <img src="${h.immagine}" alt="Hotel">
          <p>${h.nome} - ${h.prezzo}</p>
          <div class="links"><a href="${h.link}" target="_blank">üîó Prenota hotel</a></div>
        `).join("")}
      </div>
      <div class="card">
        <h3>üçΩÔ∏è Ristoranti consigliati</h3>
        <p>${data.ristoranti.join(", ")}</p>
        <div class="links"><a href="https://www.tripadvisor.it/Search?q=${data.destinazione}" target="_blank">üîó Trova ristoranti su Tripadvisor</a></div>
      </div>
      <div class="card">
        <h3>üéüÔ∏è Attivit√†</h3>
        ${data.attivita.map(a => `
          <div class="links"><a href="${a.link}" target="_blank">üîó ${a.titolo}</a></div>
        `).join("")}
      </div>
      <div class="card">
        <h3>üóìÔ∏è Itinerario Giorno per Giorno</h3>
        ${data.giorni.map(g => `
          <div class="day-card">
            <h4>Giorno ${g.giorno}</h4>
            <p>${g.descrizione}</p>
          </div>
        `).join("")}
      </div>
    `;

    // Mostra pulsante PDF solo se non siamo gi√† in modalit√† PDF
    if(!pdfMode){
      btnPDF.style.display = "block";
      btnPDF.onclick = () => {
        window.print(); // Stampa/Salva come PDF
      }
    } else {
      window.print();
    }
  })();
}
</script>
</body>
</html>
