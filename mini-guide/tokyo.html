<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tokyo – Mini-guida (5 giorni) | GlobalGlide360</title>
<meta name="description" content="Mini-guida di Tokyo: itinerario reale 5 giorni con link a disponibilità aggiornate per voli, hotel e attività.">
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

<!-- Travelpayouts LinkSwitcher -->
<script data-noptimize="1" data-cfasync="false" data-wpfc-render="false">
  (function () {
      var script = document.createElement("script");
      script.async = 1;
      script.src = 'https://tpembars.com/NDU0MTUz.js?t=454153';
      document.head.appendChild(script);
  })();
</script>
</head>
<body class="bg-blue-50 text-gray-800">

<!-- HEADER -->
<header class="bg-white shadow py-6 px-6">
  <div class="max-w-6xl mx-auto flex items-center justify-between">
    <a href="/" class="flex items-center">
      <img src="/img/logo.png" alt="GlobalGlide360" class="h-14 w-auto">
      <span class="ml-3 text-2xl font-bold text-blue-800">GlobalGlide360</span>
    </a>
    <nav class="hidden md:flex items-center space-x-6 text-blue-800">
      <a href="/mini-guide/" class="hover:underline">Mini-guide</a>
      <a href="/chi-siamo.html" class="hover:underline">Chi siamo</a>
      <a href="/contatti.html" class="hover:underline">Contatti</a>
    </nav>
  </div>
</header>

<main class="max-w-5xl mx-auto p-6">
  <h1 class="text-3xl font-bold text-blue-900 mb-2">Tokyo — 5 giorni</h1>
  <p class="text-gray-700 mb-6">Itinerario reale con link a disponibilità aggiornate (voli, hotel, esperienze).</p>

  <!-- Parametri rapidi -->
  <div class="bg-white rounded shadow p-4 mb-6 grid grid-cols-1 md:grid-cols-2 gap-4">
    <label class="block text-sm">Origine (IATA)
      <input id="from" class="w-full border rounded px-3 py-2 mt-1" placeholder="ROM/MXP/FCO" value="ROM">
    </label>
    <label class="block text-sm">Destinazione
      <input id="dest" class="w-full border rounded px-3 py-2 mt-1" placeholder="Tokyo / NRT" value="Tokyo">
    </label>
    <label class="block text-sm">Check-in
      <input id="checkin" type="date" class="w-full border rounded px-3 py-2 mt-1">
    </label>
    <label class="block text-sm">Check-out
      <input id="checkout" type="date" class="w-full border rounded px-3 py-2 mt-1">
    </label>
    <label class="block text-sm">Adulti
      <input id="adults" type="number" min="1" value="2" class="w-full border rounded px-3 py-2 mt-1">
    </label>
    <label class="block text-sm">Bambini
      <input id="children" type="number" min="0" value="0" class="w-full border rounded px-3 py-2 mt-1">
    </label>
  </div>

  <!-- CTA -->
  <div class="bg-white rounded shadow p-4 mb-8 space-y-2">
    <h2 class="text-xl font-semibold text-blue-800">Prenotazioni rapide</h2>
    <div class="flex flex-wrap gap-3">
      <a id="cta-volo"  class="inline-block bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800" target="_blank" rel="noopener">Vedi disponibilità volo</a>
      <a id="cta-hotel" class="inline-block bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700" target="_blank" rel="noopener">Vedi disponibilità alloggi</a>
      <a id="cta-exp"   class="inline-block bg-yellow-500 text-gray-900 px-4 py-2 rounded hover:bg-yellow-600" target="_blank" rel="noopener">Esplora attività</a>
    </div>
    <p class="text-xs text-gray-500">I link aprono le pagine ufficiali con i campi già impostati (risultati reali).</p>
  </div>

  <!-- Itinerario -->
  <section class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <article class="bg-white rounded shadow p-4"><h3 class="font-semibold text-blue-800 mb-1">Giorno 1 – Shibuya & Shinjuku</h3><p class="text-sm text-gray-700">Arrivo, check-in, Shibuya Crossing, Hachikō, serata a Shinjuku.</p></article>
    <article class="bg-white rounded shadow p-4"><h3 class="font-semibold text-blue-800 mb-1">Giorno 2 – Asakusa & Ueno</h3><p class="text-sm text-gray-700">Sensō-ji, Nakamise-dori, parco di Ueno e musei.</p></article>
    <article class="bg-white rounded shadow p-4"><h3 class="font-semibold text-blue-800 mb-1">Giorno 3 – Akihabara & Odaiba</h3><p class="text-sm text-gray-700">Akihabara tech/anime, teamLab a Odaiba, Rainbow Bridge.</p></article>
    <article class="bg-white rounded shadow p-4"><h3 class="font-semibold text-blue-800 mb-1">Giorno 4 – Meiji & Harajuku</h3><p class="text-sm text-gray-700">Santuario Meiji, Takeshita-dori, Omotesandō.</p></article>
    <article class="bg-white rounded shadow p-4"><h3 class="font-semibold text-blue-800 mb-1">Giorno 5 – Nikko/Kamakura (opz.)</h3><p class="text-sm text-gray-700">Escursione fuori città o shopping a Ginza.</p></article>
  </section>
</main>

<!-- FOOTER -->
<footer class="bg-white text-center py-6 mt-8 border-t">
  <p class="text-sm text-gray-500">&copy; 2025 GlobalGlide360</p>
</footer>

<!-- ================= GG CORE INLINE + SCRIPT STABILE ================= -->
<script>
/* === GG core inline === */
window.GG_CFG = window.GG_CFG || { sky_partner:"", bkg_aid:"", gyg_partner:"" };
const pad = n => n.toString().padStart(2,'0');
const localISO = d => `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
const addDays = (dateStr, days) => {
  if(!dateStr) return "";
  const [y,m,dd] = dateStr.split('-').map(Number);
  const d = new Date(y, m-1, dd);
  d.setDate(d.getDate()+days);
  return localISO(d);
};
const cleanIATA = v => (v||"").trim().toUpperCase().slice(0,3);

window.ggBuildFlight = ({from, to, dep, ret, adults=2, cabin='economy'})=>{
  const base = `https://www.skyscanner.net/transport/flights/${cleanIATA(from)}/${cleanIATA(to)}/${dep}${ret?`/${ret}`:""}/`;
  const qs = new URLSearchParams({adults, cabinclass:cabin, locale:'it-IT', currency:'EUR'});
  if (window.GG_CFG.sky_partner) qs.set('associateid', window.GG_CFG.sky_partner);
  return `${base}?${qs.toString()}`;
};
window.ggBuildHotel = ({dest, checkin, checkout, adults=2, children=0, rooms=1})=>{
  const u = new URL('https://www.booking.com/searchresults.html');
  u.searchParams.set('ss', dest);
  u.searchParams.set('checkin', checkin);
  u.searchParams.set('checkout', checkout || addDays(checkin,3));
  u.searchParams.set('group_adults', adults);
  u.searchParams.set('group_children', children);
  u.searchParams.set('no_rooms', rooms);
  if (window.GG_CFG.bkg_aid) u.searchParams.set('aid', window.GG_CFG.bkg_aid);
  return u.toString();
};
window.ggBuildExp = ({city, fromDate, toDate, pax})=>{
  const u = new URL('https://www.getyourguide.com/s/');
  u.searchParams.set('q', city);
  if (fromDate) u.searchParams.set('date_from', fromDate);
  if (toDate)   u.searchParams.set('date_to', toDate);
  if (pax)      u.searchParams.set('number_of_participants', pax);
  if (window.GG_CFG.gyg_partner) u.searchParams.set('partner_id', window.GG_CFG.gyg_partner);
  return u.toString();
};

/* === Script pagina “stabile” === */
document.addEventListener('DOMContentLoaded', function () {
  const $ = id => document.getElementById(id);

  // 1) Imposta date di default e CONGELA in memoria
  const today=new Date(), in7=new Date(today), in12=new Date(today);
  in7.setDate(today.getDate()+7); in12.setDate(today.getDate()+12);
  const defaultCheckin  = localISO(in7);
  const defaultCheckout = localISO(in12);

  if ($('#checkin')  && !$('#checkin').value)  $('#checkin').value  = defaultCheckin;
  if ($('#checkout') && !$('#checkout').value) $('#checkout').value = defaultCheckout;

  // Stato "toccato dall'utente"
  const touched = { checkin:false, checkout:false, from:false, dest:false, adults:false, children:false };

  // 2) Funzione che legge i valori "stabili"
  function getParams(){
    const from  = ($('#from') && (touched.from ? $('#from').value : ($('#from').value || 'ROM'))) || 'ROM';
    const dest  = ($('#dest') && (touched.dest ? $('#dest').value : ($('#dest').value || document.title.split('–')[0].trim()))) || 'Tokyo';

    // se l'utente NON ha toccato le date, usa i default congelati
    const ci = $('#checkin')  ? (touched.checkin  ? $('#checkin').value  : ($('#checkin').value  || defaultCheckin))  : defaultCheckin;
    const co = $('#checkout') ? (touched.checkout ? $('#checkout').value : ($('#checkout').value || defaultCheckout)) : defaultCheckout;

    const ad = $('#adults')   ? (touched.adults   ? parseInt($('#adults').value||'2',10)   : parseInt($('#adults').value||'2',10)) : 2;
    const ch = $('#children') ? (touched.children ? parseInt($('#children').value||'0',10) : parseInt($('#children').value||'0',10)) : 0;

    // IATA default per la pagina
    const path = (location.pathname||'').toLowerCase();
    let defaultIATA = 'PAR';
    if (path.includes('tokyo')) defaultIATA='NRT';
    else if (path.includes('bali')) defaultIATA='DPS';
    else if (path.includes('newyork')) defaultIATA='NYC';
    else if (path.includes('parigi')) defaultIATA='PAR';

    const toIata = dest.length===3 ? dest.toUpperCase() : defaultIATA;
    const cityForListings = dest.length===3
      ? (path.includes('tokyo') ? 'Tokyo' : path.includes('bali') ? 'Bali' : path.includes('newyork') ? 'New York' : 'Paris')
      : dest;

    return { from, dest, ci, co, ad, ch, toIata, cityForListings };
  }

  // 3) Applica href UNA VOLTA e poi SOLO su input utente
  function applyCTAs(){
    const {from,ci,co,ad,ch,toIata,cityForListings} = getParams();
    const hrefFlight = ggBuildFlight({from, to: toIata, dep: ci, ret: co, adults: ad, cabin:'economy'});
    const hrefHotel  = ggBuildHotel({dest: cityForListings, checkin: ci, checkout: co, adults: ad, children: ch, rooms: 1});
    const hrefExp    = ggBuildExp({city: cityForListings, fromDate: ci, toDate: co, pax: ad+ch});

    const aF = document.getElementById('cta-volo');
    const aH = document.getElementById('cta-hotel');
    const aE = document.getElementById('cta-exp');

    if (aF) aF.href = hrefFlight || '#';
    if (aH) aH.href = hrefHotel  || '#';
    if (aE) aE.href = hrefExp    || '#';

    console.log('[GG] href volo:', hrefFlight);
    console.log('[GG] href hotel:', hrefHotel);
    console.log('[GG] href exp:', hrefExp);
  }

  // Bind SOLO su eventi utente (non su mutazioni DOM)
  [['from','from'],['dest','dest'],['checkin','checkin'],['checkout','checkout'],['adults','adults'],['children','children']]
  .forEach(([id,key])=>{
    const el = $('#'+id);
    if (!el) return;
    el.addEventListener('input', ()=>{ touched[key]=true; applyCTAs(); });
    el.addEventListener('change', ()=>{ touched[key]=true; applyCTAs(); });
  });

  // Prima applicazione: calcola una volta e basta
  applyCTAs();
});
</script>

